<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=5,IE=9" ><![endif]-->
<!DOCTYPE html>
<html>

	<head>
		<title>智能合约平台</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<link rel="stylesheet" type="text/css" href="styles/grapheditor.css">
		<link rel="stylesheet" type="text/css" href="bot/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="styles/base2.css" />
		<link rel="stylesheet" type="text/css" href="bot/layui.css">
		<link rel="stylesheet" type="text/css" href="bot/css/modules/laydate/laydate.css" />
		<script src="function.js"></script>
		<script src="bot/jquery-1.11.3.js"></script>
		<script src="bot/bootstrap.js"></script>
		<script type="text/javascript">
			// Parses URL parameters. Supported parameters are:
			// - lang=xy: Specifies the language of the user interface.
			// - touch=1: Enables a touch-style user interface.
			// - storage=local: Enables HTML5 local storage.
			// - chrome=0: Chromeless mode.
			var urlParams = (function(url) {
				var result = new Object();
				var idx = url.lastIndexOf('?');

				if(idx > 0) {
					var params = url.substring(idx + 1).split('&');

					for(var i = 0; i < params.length; i++) {
						idx = params[i].indexOf('=');

						if(idx > 0) {
							result[params[i].substring(0, idx)] = params[i].substring(idx + 1);
						}
					}
				}
				return result;
			})(window.location.href);
			// Default resources are included in grapheditor resources
			mxLoadResources = false;
		</script>
		<script src="../common/js/utils/moment.min.js"></script>
		<script type="text/javascript" src="bot/layui.js"></script>
		<script type="text/javascript" src="bot/lay/modules/laydate.js"></script>
		<script type="text/javascript" src="js/Init.js"></script>
		<script type="text/javascript" src="jscolor/jscolor.js"></script>
		<script type="text/javascript" src="sanitizer/sanitizer.min.js"></script>
		<script type="text/javascript" src="../../../src/js/mxClient.js"></script>
		<script type="text/javascript" src="js/EditorUi.js"></script>
		<script type="text/javascript" src="js/Editor.js"></script>
		<script type="text/javascript" src="js/Sidebar.js"></script>
		<script type="text/javascript" src="js/Graph.js"></script>
		<script type="text/javascript" src="js/Shapes.js"></script>
		<script type="text/javascript" src="js/Actions.js"></script>
		<script type="text/javascript" src="js/Menus.js"></script>
		<script type="text/javascript" src="js/Format.js"></script>
		<script type="text/javascript" src="js/Toolbar.js"></script>
		<script type="text/javascript" src="js/Dialogs.js"></script>
		<script type="text/javascript" src="js/DefaultGraph.js"></script>
		<script type="text/javascript" src="js/ValidateUtil.js"></script>
	</head>

	<body class="geEditor">
		<ul class="nav nav-tabs con_nav">
			<li class="logo"><span><a href="index.html"><img src="images/img/2.png"/>智能合约管理平台</a></span></li>
			<li role="presentation" class="dropdown dropdown_l">
				<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="" aria-haspopup="true" aria-expanded="false">操作</a>
				<ul class="dropdown-menu menus menu1">
					<li id="done"><span class="glyphicon glyphicon-ok"></span><span class="ml">完成</span></li>
					<li id="saves"><span class="glyphicon glyphicon-upload"></span><span class="ml">另存为</span></li>
					<li id="saveimage"><span class="glyphicon glyphicon-export"></span><span class="ml">导出</span></li>
					<li data-toggle="modal" data-target="#myModal20" id="validate">
						</span><span class=" glyphicon glyphicon-remove-circle"></span><span class="ml">错误检查</span></li>
				</ul>
			</li>
			<li data-toggle="modal" data-target="#myModal19" class="hov" id="showPreview">预览</li>
			<li data-toggle="modal" data-target="#myModal201" id="validate1" class="hov">测试</li>
			<li id="newcontract_title" class="hov"></li>
			<li role="presentation" class="dropdown wo">
				<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
					<span class="glyphicon glyphicon-user"></span>
				</a>
				<ul class="dropdown-menu menus">
					<li class="pers">
						<span class="glyphicon glyphicon-cog"></span>
						<button type="button" class="btn btn-default btn_person " data-toggle="modal" data-target="#myModal16" id="keylist">个人设置</button>
					</li>
					<li class="help"><span class="glyphicon glyphicon-question-sign"></span><a href="help.html">帮助</a></li>
					<li id="logout"><span class="glyphicon glyphicon-remove-sign"></span>退出</li>
				</ul>
			</li>
		</ul>

		<!-- Modal -->
		<div class="modal fade" id="myModal16" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="z-index: 110000;">
			<div class="modal-dialog" role="document" aria-hidden="true">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel16">个人设置</h4>
					</div>
					<div class="modal-body">
						<!-- Nav tabs -->
						<ul class="nav nav-tabs personal" role="tablist">
							<li role="presentation" class="active">
								<a href="#home" aria-controls="home" role="tab" data-toggle="tab">公私钥管理</a>
							</li>
							<li role="presentation">
								<a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">保存设置</a>
							</li>
							<li role="presentation">
								<a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">安全设置</a>
							</li>
							<li role="presentation">
								<a href="#settings" aria-controls="settings" role="tab" data-toggle="tab">信息设置</a>
							</li>
							<li role="presentation">
								<a href="#update" aria-controls="update" role="tab" data-toggle="tab">版本更新</a>
							</li>
						</ul>
						<!-- Tab panes -->
						<div class="tab-content" style="margin-top: 50px;">
							<div role="tabpanel" class="tab-pane active" id="home">
								<table border="2" width="100%" class="key">
									<tr>
										<th></th>
										<th>公钥</th>
										<th>私钥</th>
										<th></th>
									</tr>
									<tr>
										<td>safsaf</td>
										<td>公asfds钥</td>
										<td>私钥sdfs</td>
										<td>删除</td>
									</tr>
								</table>
								<div class="modal-footer">
									<button type="button" class="btn btn-default " data-dismiss="modal" data-toggle="modal" data-target="#myModal17">申请公私钥</button>
									<button type="button" class="btn btn-primary">保存</button>
								</div>
							</div>
							<div role="tabpanel" class="tab-pane" id="profile">保存设置doing。。。</div>
							<div role="tabpanel" class="tab-pane" id="messages">安全设置doing。。。</div>
							<div role="tabpanel" class="tab-pane" id="settings">信息设置doing。。。</div>
							<div role="tabpanel" class="tab-pane" id="update">版本更新doing。。。</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- Modal -->
		<div class="modal fade" id="myModal20" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="z-index: 110000;">
			<div class="modal-dialog" role="document" aria-hidden="true">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel20">错误检查</h4>
					</div>
					<div class="modal-body" style="text-align: center;">
						<!--<p>测试版本，不必验证，请随意操作 O(∩_∩)O。</p>-->
						<table class="problem">
							<tr>
								<th>组件（图形）</th>
								<th>问题</th>
							</tr>
						</table>
						<table class="problem1">
						</table>
						<table class="problem2">
							<tr>
								<th>组件（属性）</th>
								<th>问题</th>
							</tr>
						</table>
						<table class="problem3">
						</table>
					</div>
					<div class="modal-footer" style="text-align: center;">
						<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
					</div>
				</div>
			</div>
		</div>
		<!--Modal -->
		<div class="modal fade" id="myModal201" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="z-index: 110000;">
			<div class="modal-dialog" role="document" aria-hidden="true">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title">测试</h4>
					</div>
					<div class="modal-body" style="text-align: center;">
						<!--<p>测试版本，不必验证，请随意操作 O(∩_∩)O。</p>-->
						<table class="problem">
							<tr>
								<th>组件（图形）</th>
								<th>问题</th>
							</tr>
						</table>
						<table class="problem1">
						</table>
						<table class="problem2">
							<tr>
								<th>组件（属性）</th>
								<th>问题</th>
							</tr>
						</table>
						<table class="problem3">
						</table>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
					</div>
				</div>
			</div>
		</div>
		<!-- Modal -->
		<div class="modal fade bs-example-modal-lg" id="myModal19" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="z-index: 110000;">
			<div class="modal-dialog modal-lg" role="document" aria-hidden="true">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel19">预览</h4>
					</div>
					<div class="modal-body" style="padding: 0;">
						<div class="img">
						</div>
						<div class="page3" style="width:46%; height:400px ; float: right; margin-right: 5px;">
							<div class="title c">
								<p></p>
							</div>
							<div class="con_main c">
								<div class="l">
									<p>合约编号：<span></span></p>
									<div class="owner">
									</div>
								</div>
							</div>
							<div class="con_time c">
								<div class="l">
									<p>合约创建日期：<span></span></p>
								</div>
								<div class="r">
									<p>合约起始日期：<span class="con_time_statr"></span></p>
									<p>合约截止日期：<span class="con_time_end"></span></p>
								</div>
							</div>
							<div class="con_des">
								<p>资产描述：</p>
								<div class="con_des_main">
									<p>名称：<span class="con_des_name"></span></p>
									<p>数量：<span class="con_des_num"></span></p>
									<p>型号：<span class="con_des_type"></span></p>
								</div>
							</div>
							<div class="con_info">
								<p>合约权利和义务：</p>
								<div class="con_des_mains">
								</div>
							</div>
							<div class="con_footer">
								<div class="con_footer_con">
								</div>
							</div>
						</div>
					</div>
					<div class="modal-footer" style="text-align: center;">
						<button type="button" class="btn btn-default" data-dismiss="modal" style="margin-top: 25px;">关闭</button>
					</div>
				</div>
			</div>
		</div>

		<script>
			window.onload = function() {}
		</script>

		<script type="text/javascript">
			// Extends EditorUi to update I/O action states based on availability of backend
			(function() {
				//				退出Start
				$('#logout').click(function() {
					$.ajax({
						type: "GET",
						dataType: "json",
						url: server_url + "/logout",
						success: function(res) {
							if(res.code == 200) {
								alert(res.msg)
								location.href = 'login.html';
							}
						},
						error: function(err) {
							console.log(err);
							console.log('error');
						}
					});
				})
				//				退出End
				$('#myTabs a').click(function(e) {
					e.preventDefault()
					$(this).tab('show')
				})
				$('#myTabs a[href="#profile"]').tab('show') // Select tab by name
				$('#myTabs a:first').tab('show') // Select first tab
				$('#myTabs a:last').tab('show') // Select last tab
				$('#myTabs li:eq(2) a').tab('show') // Select third tab (0-indexed)
				debugger
				var editorUiInit = EditorUi.prototype.init;

				EditorUi.prototype.init = function() {
					editorUiInit.apply(this, arguments);
					this.actions.get('export').setEnabled(true);
					// Updates action states which require a backend
					if(!Editor.useLocalStorage) {
						//						mxUtils.post(OPEN_URL, '', mxUtils.bind(this, function(req) {
						//							var enabled = req.getStatus() != 404;
						//							debugger
						//							this.actions.get('open').setEnabled(enabled || Graph.fileSupport);
						//							this.actions.get('import').setEnabled(enabled || Graph.fileSupport);
						//							this.actions.get('save').setEnabled(enabled || Graph.fileSupport);
						//							this.actions.get('saveAs').setEnabled(enabled || Graph.fileSupport);
						//							this.actions.get('export').setEnabled(enabled || Graph.fileSupport);
						//						}));
					}
				};

				// Adds required resources (disables loading of fallback properties, this can only
				// be used if we know that all keys are defined in the language specific file)
				mxResources.loadDefaultBundle = false;
				var bundle = mxResources.getDefaultBundle(RESOURCE_BASE, mxLanguage) ||
					mxResources.getSpecialBundle(RESOURCE_BASE, mxLanguage);

				// Fixes possible asynchronous requests
				mxUtils.getAll([bundle, STYLE_PATH + '/default.xml'], function(xhr) {
					// Adds bundle text to resources
					mxResources.parse(xhr[0].getText());

					// Configures the default graph theme
					var themes = new Object();
					themes[Graph.prototype.defaultThemeName] = xhr[1].getDocumentElement();

					// Main
					new EditorUi(new Editor(urlParams['chrome'] == '0', themes));
				}, function() {
					document.body.innerHTML = '<center style="margin-top:10%;">Error loading resource files. Please check browser console.</center>';
				});
			})();
		</script>
	</body>

</html>